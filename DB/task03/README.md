### Task 03

Реализовать следующие аналитические запросы на основе данных из представления [V_FACT_SALE](v_fact_sale.sql)

1. Каждый месяц компания выдает премию в размере 5% от суммы продаж менеджеру, который за предыдущие 3 месяца продал товаров на самую большую сумму

Выведите месяц, manager_id, manager_first_name, manager_last_name, премию за период с января по декабрь 2014 года

2. Компания хочет оптимизировать количество офисов, проанализировав относительные объемы продаж по офисам в течение периода с 2013-2014 гг.

Выведите год, office_id, city_name, country, относительный объем продаж за текущий год
Офисы, которые демонстрируют наименьший относительной объем в течение двух лет скорее всего будут закрыты.

3. Для планирования закупок, компанию оценивает динамику роста продаж по товарам.
Динамика оценивается как отношение объема продаж в текущем месяце к предыдущему.

Выведите товары, которые демонстрировали наиболее высокие темпы роста продаж в течение первого полугодия 2014 года.

4. Напишите запрос, который выводит отчет о прибыли компании за 2014 год: помесячно и поквартально.

Отчет включает сумму прибыли за период и накопительную сумму прибыли с начала года по текущий период.

5. Найдите вклад в общую прибыль за 2014 год 10% наиболее дорогих товаров и 10% наиболее дешевых товаров.

Выведите product_id, product_name, total_sale_amount, percent

6. Компания хочет премировать трех наиболее продуктивных (по объему продаж, конечно) менеджеров в каждой стране в 2014 году.

Выведите country, <список manager_last_name manager_first_name, разделенный запятыми> которым будет выплачена премия

7. Выведите самый дешевый и самый дорогой товар, проданный за каждый месяц в течение 2014 года.

cheapest_product_id, cheapest_product_name, expensive_product_id, expensive_product_name, month, cheapest_price, expensive_price

8. Менеджер получает оклад в 30 000 + 5% от суммы своих продаж в месяц. Средняя наценка стоимости товара - 10%

Посчитайте прибыль предприятия за 2014 год по месяцам (сумма продаж - (исходная стоимость товаров + зарплата))
month, sales_amount, salary_amount, profit_amount